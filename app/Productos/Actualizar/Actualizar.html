<style type="text/css">
    *{
        margin: 0px;
        padding: 0px;
    }
.containner-update {
    background: white;
}
.form-update-product {
    display: flex;
    flex-direction: column;
    align-items: center;
}
span {
    font-weight: bold;
    color: #000000;
    margin-bottom: 7px;
    font-size: 15px;
}
input {
    width: 88%;
    height: 35px;
    text-align: center;
    border-style: none;
    border-bottom: 2.54px solid #9f9c9c;
}
input:focus{

  outline: none;

}
.input-value-product{
        height: 35px;
        text-align: center;
}

.containner-input{

    display: flex;
        flex-direction:column;
            align-items: center;
            justify-content: center;
        
}
/*---------------------------------*/
.section-area1 {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: 50px 1fr;
    grid-template-areas: 'title title title'
                         'data1 data1 image'
                         'data2 data2 data2';
                         background: white;
}
.containner-data1 {
    grid-area: data1;
    /* padding: 20px; */
}

.containner-data2{
    grid-area:data2;
   /*  padding: 20px;*/

}

/*****************************/
.containner-data1 {

display: grid;
grid-template-columns: repeat(6, 1fr);
grid-template-rows: 1fr;
grid-column-gap: 2px;
grid-row-gap: 2px;
grid-template-areas:'serial   serial   serial  name    name     name'
                    'category category amount  amount  time     time'
                    'iva      iva      price   price   discount discount';

}


.containner-Image-Product {
    grid-area: image;
    padding: 3px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.image-product {
    width: 340px;
    height: 148px;
    border-top: 1px solid #adadad;
    border-right: 1px solid #9d9d9d;
    border-bottom: 1px solid #818181;
    border-left: 1px solid #939393;
}

.btn_send_image {
    background: orange;
    color: white;
    width: 340px;
    height: 32px;
    text-align: center;
    margin-top: 2px;
    border-style: none;
    font-weight: bold;
    font-size: 20px;
}
.Serial-input{
    grid-area:serial;
}

.title-registre-Product {
    grid-area: title;
    text-align: center;
    color: #6a6969;
}

.Name-Product-input{
    grid-area:name;
}

.Category-Product-input{
    grid-area:category;
}

.Price-Product-input{
    grid-area:price;
}

.Iva-Product-input{
    grid-area:iva;

}



.Amount-Product-input{
    grid-area:amount;
}

.Time-Product-input{
    grid-area:time;
}
.Time-Product {
    font-size: 12px;
    font-weight: bold;
}
.Discount-Product-input{
    grid-area:discount;
}


.Image{
 width: 100%;
    height: 32px;

}



/*---------------------------------------------------*/
/*section-area2*/
.section-area2 {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: 32px 1fr;
    grid-column-gap: 3px;
    grid-row-gap: 3px;
    grid-template-areas: 'Title Title Title Title  Title'
                         'Riff  Name  Addres Phone Email';
    margin-bottom: 10px;
    width: 100%;
    background: white;
}
.Title-registre-Supplier{
grid-area:Title;
text-align: center;
color: #6a6969;
    }
.Riff-Product-input-Supplier{
grid-area:Riff;
    }

.Name-Product-input-Supplier{
grid-area:Name;
    }

.Addres-Product-input-Supplier{

grid-area:Addres;
    }

.Phone-Product-input-Supplier{
grid-area:Phone;
        }

.Email-Product-input-Supplier{
    grid-area:Email;
}   



/***********containner-btn********************/
.containner-btn {
    width: 100%;
    grid-area: btn;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-evenly;
}
.btn-product {
    width: 48%;
    height: 40px;
    color: white;
    border-radius: 5px;
    font-weight: bold;
    font-size: 16px;
}
.save{
    background:#20AD10
}

.reset{
    background:#0073A8;
}

.exit{
    background: red;
}
/*-------------------------------*/
.Iva-Product-containner {
    width: 100%;
}
.Iva-Product {
    height: 35px;
    text-align: center;
    width: 80%;
}
/*------------------------------*/
.Price-Product-containner {
    width: 100%;
}

.Price-Product {
    width: 80%;
}
/*-----------------------*/
.Discount-Product-containner {
    width: 100%;
}

.Discount-Product{
    width: 80%;
}

.select-category {
    width: 80%;
}
</style>

<div class="containner-update">
    <div class="form-update-product">
    <!--------->
        <h1 class="title-registre-Product" id="title_pagina">Actualización de Producto</h2>
        <!--------->
        <section  class="section-area1">
                <h2 class="title-registre-Product" id="title_pagina">Producto</h2>
                <div class="containner-data1">
                  
                    <label class="containner-input Serial-input">
                            <span id="serial_span">Código</span>
                            <input type="text" name="Serial Product" id="Serial_Product"  class="Serial-Product" placeholder="Serial Product" required>
                    </label>

                    <label class="containner-input Name-Product-input">
                            <span id="Name_procduct_span">Nombre Producto</span>
                            <input type="text" name="Name Product" id="Name_Product"  class="Name-Product" placeholder="Name Product" required>
                    </label>

                    <label class="containner-input Category-Product-input">
                        <span id="Category_Product_span">Categoria</span>
                        <select class="select-category" id="Category_Product"></select>
                    </label>

                    <label class="containner-input  Amount-Product-input">
                            <span id="Amount_Product_span">Cantidad</span>
                            <input type="number" name="Amount Product" id="Amount_Product"  class="Amount-Product" placeholder="Amount Product" min="0" value="0"  required>
                    </label>
                   
                    <label class="containner-input Time-Product-input">
                        <span id="Time_Product_span">Tiempo</span>
                        <input type="datetime-local" id="Time_Product" class="Time-Product" required>
                    </label>               

                    <label class="containner-input  Iva-Product-input">
                        <span id="Iva_Product_span">Iva producto</span>
                        <span class="Iva-Product-containner" >
                            <input type="number" name="Iva Product" id="Iva_Product"  class="input-value-product Iva-Product" placeholder="Iva Product" min="0" value="16" required>
                            <span class="moneda" >%</span>                                        
                        </span>
                    </label>

                    <label class="containner-input  Price-Product-input">
                       <span id="Price_Product_span">Precio $->Bs</span>                
                       <span class="Price-Product-containner" >
                                <input type="number" name="Price Product" id="Price_Product_usb"  class="input-value-product Price-Product" placeholder="Precio" min="1" value="1"required>
                                <span class="moneda" id="type_moneda">$</span>
                        </span> 
                        <span class="Price-Product-containner" >
                                <input type="number" name="Price Product" id="Price_Product_vez"  class="input-value-product Price-Product" placeholder="Precio" min="1" value="0"required>
                                <span class="moneda" id="type_moneda">Bs</span>
                        </span>                       
                    </label> 

                    <label class="containner-input Discount-Product-input">
                        <span id="Discount_Product_price_span">Descuento</span> 
                            <span class="Discount-Product-containner" >
                                <input type="number" name="Discount Product" id="Discount_Product_price"  class="input-value-product Discount-Product" placeholder="Discount Product" min="0" value="0" required>                                           
                            </span>                                                         
                    </label>
            
                </div>
                <div class="containner-Image-Product">
                    <img src="UnoStock.png" class="image-product" id="imagen_product">
                    <button id="Image_Product" class="btn_send_image">Seleccionar Imagen</button>   
                </div>
        </section>
        <!-----
        <section  class="section-area2">
            <h2 class="Title-registre-Supplier" id="Supplier">Proveedor</h2>

            <label class="containner-input Riff-Product-input-Supplier">
            <span id="Riff_Supplier_span">Riff</span>
            <input type="text" name="Riff Product" id="Riff_Product_Supplier"  class="Riff-Product-Supplier" placeholder="Riff" required>
            </label>

            <label class="containner-input Name-Product-input-Supplier">
            <span id="Name_Supplier_span">Nombre</span>
            <input type="text" name="Name Product" id="Name_Product_Supplier"  class="Name-Product-Supplier" placeholder="Nombre" required>
            </label>

            <label class="containner-input Addres-Product-input-Supplier">
            <span id="Addres_Product_Supplier_span">Dirección</span>
            <input type="text" name="Addres Supplier Product" id="Addres_Product_Supplier"  class="Addres-Product-Supplier" placeholder="Dirección" required>
            </label>

            <label class="containner-input Email-Product-input-Supplier">
            <span id="Email_Product_Supplier_span">Correo</span>
            <input type="email" name="Email Supplier Product" id="Email_Product_Supplier"  class="Email-Product-Supplier" placeholder="Correo" required>
            </label>

            <label class="containner-input Phone-Product-input-Supplier">
            <span id="Phone_Product_Supplier_span">Telefono</span>
            <input type="tel" name="Phone Supplier Product" id="Phone_Product_Supplier"  class="Phone-Product-Supplier" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}" placeholder="Telefono" required>
            </label>
        </section>
   ------>
        <section class="containner-btn">
            <button class="btn-product save" type="submit" value="save" id="btn_save" >Guardar</button>
            <button class="btn-product exit " id="btn_exit">Salir</button>      
        <section >
    <!--------->
    </div>     
</div>
<script type="text/javascript">
var data_new_obj;

let permission_product=false;
let permission_supplier_product=false;
/////product
let data_Serial_Product=document.getElementById("Serial_Product");
let data_Name_Product=document.getElementById("Name_Product");
let data_Price_Product=document.getElementById("Price_Product_vez");
let data_Iva_Product=document.getElementById("Iva_Product");
let data_Category_Product=document.getElementById("Category_Product");
let data_Amount_Product=document.getElementById("Amount_Product");
let data_Time_Product=document.getElementById("Time_Product");
    data_Time_Product.value=TimeSelect();
let data_type_moneda=document.getElementById("type_moneda");
let data_Discount_Product_price=document.getElementById("Discount_Product_price");
let image_pre_wiev = document.getElementById("imagen_product");


api.send("get-Informacion-producto-actualizar")
api.receive("Informacion-producto-actualizar",(event,producto)=>{

  console.log("Actualizar-productos",producto)

    document.getElementById("Serial_Product").value=producto.cod;
    document.getElementById("Name_Product").value=producto.nombre;
    document.getElementById("Price_Product_vez").value=producto.precio;
    document.getElementById("Iva_Product").value=producto.iva;
    document.getElementById("Category_Product").value=producto.categoria;
    document.getElementById("Amount_Product").value=producto.cant;
    document.getElementById("Time_Product").value=producto.time_registro;
    document.getElementById("Discount_Product_price").value=producto.descuento;
    document.getElementById("imagen_product").src=producto.image;


})


/*--------------------------------*/
api.receive("Informacion-obtenida-categoria-lista-actualizar-producto",(event,data)=>{

    console.log(data)
    document.getElementById("Category_Product").innerHTML="";
    data.forEach((categoria,index)=>{

        document.getElementById("Category_Product").innerHTML+=`<option value="${categoria.nombre}">${categoria.nombre}</option>`;

    })
})


/************get information image*********************/

function TimeSelect(){

        const fechaActual = new Date();
        // Formatea la fecha y hora para el input (YYYY-MM-DDTHH:MM)
        const year = fechaActual.getFullYear();
        const month = String(fechaActual.getMonth() + 1).padStart(2, '0');
        const day = String(fechaActual.getDate()).padStart(2, '0');
        const hours = String(fechaActual.getHours()).padStart(2, '0');
        const minutes = String(fechaActual.getMinutes()).padStart(2, '0');

        return `${year}-${month}-${day}T${hours}:${minutes}`;

}
/*****************************************************/

function capture_new_data(){

    if(data_Serial_Product.value!="" && data_Name_Product.value!=" " && data_Category_Product.value!=" " && data_Price_Product.value!=" " && data_Iva_Product.value!=" " && data_Discount_Product_price.value!=" " && data_Amount_Product.value!=" ") {

                                permission_product=true;

                        }
                        else{
                                        
                                permission_product=false;

                            }

   /**************************************************************************/   

        if(permission_product==true){

                    data_new_obj={                       
                        code:data_Serial_Product.value,
                        name:(data_Name_Product.value).toLowerCase(),
                        price:data_Price_Product.value,
                        iva_product:data_Iva_Product.value,
                        discount_Product_price:data_Discount_Product_price.value,
                        image:image_pre_wiev.src,
                        category:data_Category_Product.value,
                        amount:data_Amount_Product.value,
                        Registration_Time:TimeSelect(),
                    }
                    console.log('save_update_product',data_new_obj)
                    
                    api.send('save_update_product',data_new_obj);

                                
        }
        else{

            //alert(traslate_lenguge(clave_lenguaje,"campos en el area vacios del producto o proveedor"))

            //api.send("alert_new_product",traslate_lenguge(clave_lenguaje,"campos en el area vacios del producto o proveedor"))
        }

}

/***************BUTTON DATA*************************/
let btn_select_image = document.getElementById("Image_Product");

btn_select_image.addEventListener('click', function(evt){

   evt.stopPropagation();
   api.send('Select_image_product_update')
                  
  
})

api.receive("get-select-image-product_update", (event,imagenproduct) => {
                                             
        image_pre_wiev.src=imagenproduct;

})
/*---------------------------------------------------------------------*/

let btn_save = document.getElementById("btn_save");

btn_save.addEventListener('click', function(evt){

    evt.preventDefault();
    

    capture_new_data()

    api.send('Refrescar-data-area-producto')  

     setTimeout(function(){window.close() },1500)

  
})

let btn_exit = document.getElementById("btn_exit");

btn_exit.addEventListener('click', function(evt){

    api.send('Refrescar-data-area-producto')  

        setTimeout(function(){window.close() },1500)


})
/*------------------------------------------------------------------------*/

let Valor_money_cambio;

async function obtenerCambioUSD() {
  try {
    const respuesta = await fetch("https://ve.dolarapi.com/v1/dolares/oficial");
    const datos = await respuesta.json();

        return datos.promedio;

  } catch (error) {
    console.error("Error al obtener el cambio:", error);
    return null;
  }
}

// Uso de la función
obtenerCambioUSD().then(valor => {
    
    Valor_money_cambio=valor
       Price_Product_usb.value=(Price_Product_vez.value/Valor_money_cambio).toFixed(2)
       Price_Product_vez.value=(Price_Product_usb.value*Valor_money_cambio).toFixed(2)


});
/*--------------------------------*/
let Price_Product_usb = document.getElementById("Price_Product_usb")
let Price_Product_vez = document.getElementById("Price_Product_vez")

Price_Product_usb.addEventListener('click',function(evet){

    console.log("USD_VEZ")
    Price_Product_vez.value=(Price_Product_usb.value*Valor_money_cambio).toFixed(2)

})

Price_Product_vez.addEventListener('click',function(evet){

  console.log("VEZ_USD")
  Price_Product_usb.value=(Price_Product_vez.value/Valor_money_cambio).toFixed(2)



})
</script>
 
